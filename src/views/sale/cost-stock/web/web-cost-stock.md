
#### ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡πÄ‡∏•‡∏∞‡πÄ‡πÄ‡∏Å‡πâ‡πÑ‡∏Ç code ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÄ‡πÄ‡∏ö‡∏ö‡πÉ‡∏ô E:\coqo_duangkeaw\Code\jeweley-ui\CLAUDE.md ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö
#### ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ prime-vue components >> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ generic-components ‡πÑ‡∏´‡∏° >> ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ re-used >> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡πÄ‡∏•‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ ‡∏ó‡∏µ‡πà E:\coqo_duangkeaw\Code\jeweley-ui\src\components\prime-vue

>> ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
>> flow >>>>>  ‡∏≠‡∏≠‡∏Å‡πÄ‡πÄ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤(mobile) >> ‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤(web) >> ‡∏≠‡∏≠‡∏Å‡∏ú‡∏•‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤(web & mobile)
>> ‡∏≠‡∏≠‡∏Å‡πÄ‡πÄ‡∏ö‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏µ‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡πâ‡∏Ñ‡∏≤‡πÉ‡∏´‡∏°‡πà ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡∏Å‡πÄ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏°‡∏≤‡πÄ‡πÄ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏°‡∏≤
>> **‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏**: Web version ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Tablet & Desktop ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô, Mobile ‡∏à‡∏∞‡∏°‡∏µ route ‡πÅ‡∏•‡∏∞ layout ‡πÅ‡∏¢‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å

## 1. ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô (Web - Tablet & Desktop)

  **Flow**: Get Stock >> ‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤ >> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (export document) >> ‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡∏°‡πà >> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

  **Location**: `/sale/cost-stock-edit` (E:\coqo_duangkeaw\Code\jeweley-ui\src\views\sale\cost-stock\web\cost-edit\)

  ### Component Structure:
  ```
  /cost-stock/web/cost-edit/
  ‚îú‚îÄ‚îÄ index-view.vue (Main orchestrator)
  ‚îú‚îÄ‚îÄ components/
  ‚îÇ   ‚îú‚îÄ‚îÄ search-stock-view.vue (Stock search)
  ‚îÇ   ‚îî‚îÄ‚îÄ appraisal-form-view.vue (Appraisal form)

  /components/prime-vue/
  ‚îî‚îÄ‚îÄ AutoCompleteGeneric.vue (Reusable AutoComplete component)
  ```

  ### Features Implemented:
  ‚úÖ Stock Information Section (Read-only)
     - ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï (Stock Number)
     - ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Product Code)
     - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Description)

  ‚úÖ Customer Information (Modal-based Search & Create) - **Optional Field**
     - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ button (Search Customer - opens search modal)
     - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà button (Create New Customer - opens create modal, auto-fill customer info)
     - ‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Customer Name - display only)
     - ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (Customer Address - display only)
     - ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ (Customer Phone - display only)
     - ‡∏≠‡∏µ‡πÄ‡∏°‡∏• (Customer Email - display only)
     - ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (Remark/Notes - editable)
     - **Note**: Customer information is optional, can save without customer data

  ‚úÖ Price Appraisal Section
     - DataTable with groups: Gold, Gem, Worker, Embed, ETC
     - Auto-calculate total price per row (qty * qtyPrice + qtyWeight * qtyWeightPrice)
     - Group totals and grand total calculation
     - Add/remove transaction items with dropdown selection
     - **Auto-add "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡πâ‡∏ô" (RINGP)** for Ring products (productType === 'R')
       - Automatically added to Gold group when stock is fetched
       - Only added if not already exists in transaction items
     - **Smart Input for Item Description (All types use AutoCompleteGeneric)**:
       - **All AutoComplete allow free text input** (forceSelection: false)
       - **Enter key does NOT submit form** (prevented in AutoCompleteGeneric component)
       - **Existing items from stock**: Read-only (disabled)
       - **New items - Dynamic based on group**:
         - **Gold (‡∏ó‡∏≠‡∏á)**: Hardcoded list + API combined (Master/MasterGold)
           - Hardcoded: "RINGP" (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡πâ‡∏ô)
           - API: Additional gold types from master database
           - Display: code only
           - Free text allowed for custom gold types
         - **Gem (‡∏ß‡∏±‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö)**: Search from StockGem API (‡∏û‡∏•‡∏≠‡∏¢/‡πÄ‡∏û‡∏ä‡∏£)
           - Minimum 3 characters to trigger search
           - Auto-fill price when selected
           - Free text allowed for custom gems
         - **Worker (‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á)**: Static list (temporary master)
           - ‡∏Ñ‡πà‡∏≤‡∏ä‡∏∏‡∏ö, ‡∏Ñ‡πà‡∏≤‡πÅ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå, ‡∏Ñ‡πà‡∏≤‡∏¢‡∏¥‡∏á‡πÄ‡∏•‡πÄ‡∏ã‡∏≠‡∏£‡πå, ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏ó‡∏≥‡πÅ‡∏õ‡πâ‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏±‡∏î‡∏û‡∏•‡∏≠‡∏¢
           - Free text allowed
         - **Embed (‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á)**: Static list (temporary master)
           - ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡∏û‡∏•‡∏≠‡∏¢, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÄ‡∏û‡∏ä‡∏£, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÄ‡∏Å‡∏™‡∏£, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô
           - Free text allowed
         - **ETC (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)**: Static list (temporary master)
           - ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå, ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á, ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°, ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ, ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
           - Free text allowed

  ‚úÖ Action Buttons
     - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (Save) ‚Üí isOriginCost = false
     - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å (Save as Origin Cost) ‚Üí isOriginCost = true
     - ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å (Cancel)

  ‚úÖ Responsive Design (Tablet & Desktop)
     - Uses new web responsive utility classes from `responsive-style/web/`
     - DataTable with horizontal scroll on tablet
     - Button groups wrap naturally
     - Tested at 1024px (tablet) and 1280px+ (desktop)
     - Import: `@import '@/assets/scss/responsive-style/web';`

  ### Changes from Original Requirements:
  - ‚ùå Removed Materials Section (‡∏ó‡∏≠‡∏á | ‡πÄ‡∏û‡∏ä‡∏£ | ‡∏û‡∏•‡∏≠‡∏¢)
  - ‚ùå Removed "Cost Per Piece" display and "Use cost as appraisal price" checkbox (not used)
  - ‚úÖ Stock information made read-only
  - ‚úÖ Customer selection via modal with two options:
    - Search existing customer (CustomerSearchModal)
    - Create new customer (CustomerCreateModal) - auto-fills customer info after creation
  - ‚úÖ Customer info display: name, address, phone, email (read-only)
  - ‚úÖ Customer information is **optional** (not required for saving)
  - ‚úÖ Remark field remains editable
  - ‚úÖ Integrated with new API endpoint `AddProductCostDeatialVersion`
  - ‚úÖ **Smart Input System** for transaction items:
    - Existing items from stock: Read-only input (cannot edit)
    - New items added by user: AutoCompleteGeneric with dynamic configuration
    - **All AutoComplete allow free text** - Users can type custom values not in lists
    - **Enter key prevention** - Pressing Enter in AutoComplete does NOT submit form
    - Gold: Hardcoded list (RINGP) + API combined
    - Gem: API search with auto-fill price
    - Worker/Embed/ETC: Temporary static lists with free text allowed
  - ‚úÖ **Auto-add "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡πâ‡∏ô" (RINGP)** for Ring products (productType === 'R')
  - ‚úÖ Responsive for Tablet & Desktop only (Mobile has separate routes)

  ### API Integration:

  #### 1. Save Appraisal API
  - ‚úÖ **Implemented**: Save API endpoint `AddProductCostDeatialVersion`
  - API Store: `usrStockProductApiStore.fetchAddProductCostDeatialVersion()`
  - Location: `src/stores/modules/api/stock/product-api.js`
  - Request mapping:
    - Stock Number (stockNumber or stockNumberOrigin)
    - Customer Info (code, name, address, tel, email) - optional
    - Remark - optional
    - Price Transactions (prictransection array with qty, qtyPrice, qtyWeight, qtyWeightPrice)
    - **isOriginCost**:
      - `false` when clicking "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" (Save)
      - `true` when clicking "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å" (Save as Origin Cost)

  #### 2. Master Data APIs (AutoComplete)

  **Gold (‡∏ó‡∏≠‡∏á)**:
  - ‚úÖ Source: Hardcoded list + API combined
  - Hardcoded list: `hardcodedGoldList` in component
    - RINGP (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡πâ‡∏ô)
  - API: `master-store.js` ‚Üí `fetchGold()`
  - Endpoint: `Master/MasterGold`
  - Returns: Combined array (hardcoded + API, no duplicates)
  - Usage: Static list for AutoComplete
  - **Free text allowed**: Can type custom gold types not in list

  **Gem (‡∏ß‡∏±‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö/‡∏û‡∏•‡∏≠‡∏¢/‡πÄ‡∏û‡∏ä‡∏£)**:
  - ‚úÖ Endpoint: `StockGem/Search`
  - Trigger: Minimum 3 characters typed
  - Returns: Array of gem/diamond items with name, code, price
  - Auto-fill: Automatically sets `qtyWeightPrice` when gem selected
  - **Free text allowed**: Can type custom gems not in database

  **Worker (‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á)**:
  - ‚è≥ **Temporary**: Static list in component (`masterWorkerList`)
  - üîú **TODO**: Create API endpoint when master data is ready
  - Current items: ‡∏Ñ‡πà‡∏≤‡∏ä‡∏∏‡∏ö, ‡∏Ñ‡πà‡∏≤‡πÅ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå, ‡∏Ñ‡πà‡∏≤‡∏¢‡∏¥‡∏á‡πÄ‡∏•‡πÄ‡∏ã‡∏≠‡∏£‡πå, ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏ó‡∏≥‡πÅ‡∏õ‡πâ‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏±‡∏î‡∏û‡∏•‡∏≠‡∏¢
  - **Free text allowed**: Can type custom worker items

  **Embed (‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á)**:
  - ‚è≥ **Temporary**: Static list in component (`masterEmbedList`)
  - üîú **TODO**: Create API endpoint when master data is ready
  - Current items: ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡∏û‡∏•‡∏≠‡∏¢, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÄ‡∏û‡∏ä‡∏£, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÄ‡∏Å‡∏™‡∏£, ‡∏á‡∏≤‡∏ô‡∏ù‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô
  - **Free text allowed**: Can type custom embed items

  **ETC (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)**:
  - ‚è≥ **Temporary**: Static list in component (`masterETCList`)
  - üîú **TODO**: Create API endpoint when master data is ready
  - Current items: ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå, ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á, ‡∏Ñ‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏ô‡∏µ‡∏¢‡∏°, ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ, ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
  - **Free text allowed**: Can type custom ETC items

  ### Generic Components:

  #### AutoCompleteGeneric.vue
  **Location**: `src/components/prime-vue/AutoCompleteGeneric.vue`

  **Purpose**: Reusable AutoComplete component with support for both API and static list modes

  **Key Features**:
  - ‚úÖ **Free text input** - Users can type any value (forceSelection: false by default)
  - ‚úÖ **Enter key prevention** - Pressing Enter does NOT submit parent form
  - ‚úÖ **Dual mode support** - API or static list modes
  - ‚úÖ **Custom styling** - Flexible styling options

  **Modes**:
  1. **API Mode** (useStaticList: false) - Fetch data from API endpoint
  2. **Static List Mode** (useStaticList: true) - Use provided static options

  **Props**:
  - `modelValue` - v-model binding
  - **API Mode Props**:
    - `apiEndpoint` - API endpoint path (e.g., "StockGem/Search")
    - `searchField` - Field name for search query (default: "text")
    - `additionalSearchParams` - Additional search parameters (Object)
  - **Static List Mode Props**:
    - `staticOptions` - Array of static options (e.g., [{ code: 'RINGP', name: '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏õ‡πâ‡∏ô' }])
    - `useStaticList` - Enable static list mode (default: false)
  - **Common Props**:
    - `placeholder` - Placeholder text
    - `optionLabel` - Field name for option display (default: "name")
    - `forceSelection` - Force user to select from list (default: false) **[IMPORTANT: Set to false for free text]**
    - `minLength` - Minimum characters to trigger search (default: 1)
    - `disabled` - Disable state
    - `customClass` - Custom CSS class
    - `customStyle` - Custom inline styles
    - `skipLoading` - Skip global loading indicator (default: true)

  **Events**:
  - `@update:modelValue` - Model value changed
  - `@item-select` - Item selected from suggestions
  - `@search-complete` - Search completed with results

  **Slots**:
  - `#option` - Custom option template (receives `{ option }`)

  **Usage Examples**:

  **API Mode (Gem Search)**:
  ```vue
  <AutoCompleteGeneric
    v-model="selectedGem"
    apiEndpoint="StockGem/Search"
    searchField="text"
    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏•‡∏≠‡∏¢/‡πÄ‡∏û‡∏ä‡∏£..."
    optionLabel="name"
    :forceSelection="true"
    :minLength="3"
    @item-select="onGemSelected"
  >
    <template #option="{ option }">
      <div>{{ option.name }} - {{ option.code }}</div>
    </template>
  </AutoCompleteGeneric>
  ```

  **Static List Mode (Gold)**:
  ```vue
  <AutoCompleteGeneric
    v-model="selectedGold"
    :useStaticList="true"
    :staticOptions="masterGoldList"
    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏≠‡∏á..."
    optionLabel="code"
    :forceSelection="false"
    @item-select="onGoldSelected"
  >
    <template #option="{ option }">
      <div>{{ option.code }}</div>
    </template>
  </AutoCompleteGeneric>
  ```

  ### References:
  - Stock fetch logic: `quotation-view.vue` line 970
  - Original appraisal screen: `edit-stock-view.vue` ~line 100
  - AutoComplete pattern: `update-process-view.vue` line 333

## 2. ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡πÅ‡∏ú‡∏ô (Plan-based Appraisal) - Web Version

  **Flow**: ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤ (Mobile) ‚Üí **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô (Web)** ‚Üí ‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤ ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‚Üí ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ú‡∏ô

  **Location**: Same as ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏ô - `/sale/cost-stock-edit`

  ### Component Structure:
  ```
  /cost-stock/web/cost-edit/
  ‚îú‚îÄ‚îÄ index-view.vue (Main orchestrator with plan handling)
  ‚îú‚îÄ‚îÄ components/
  ‚îÇ   ‚îú‚îÄ‚îÄ search-stock-view.vue (Stock search + Plan list button with badge)
  ‚îÇ   ‚îú‚îÄ‚îÄ stock-cost-plan-modal.vue (Plan selection modal) ‚ú® NEW
  ‚îÇ   ‚îî‚îÄ‚îÄ appraisal-form-view.vue (Appraisal form with plan info display)

  /components/prime-vue/
  ‚îú‚îÄ‚îÄ DataTableWithPaging.vue (Reusable DataTable with pagination)
  ‚îî‚îÄ‚îÄ Dialog.vue (PrimeVue Dialog for modal)
  ```

  ### Features Implemented:

  ‚úÖ **Plan List Button with Notification Badge**
     - Location: `search-stock-view.vue`
     - ‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤" (‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á warning)
     - Badge ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà `isActive = true` AND `statusId = 10` (Pending)
     - Auto-refresh badge count on component mount
     - Position: ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"

  ‚úÖ **Plan Selection Modal** (`stock-cost-plan-modal.vue`)
     - DataTable with pagination, sorting, filtering
     - Single selection mode (Radio button)
     - Columns:
       - ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡∏ô (Running)
       - ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏¥‡∏ï (Stock Number)
       - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status) with color-coded badges
       - ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (Remark)
       - ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á (Create By)
       - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á (Create Date)
       - ‡∏ú‡∏π‡πâ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Update By)
       - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Update Date)
     - Filter: Only shows plans with `isActive = true` AND `statusId = 10` (Pending)
     - Action: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏ô‡∏µ‡πâ" button to confirm selection

  ‚úÖ **Plan Information Display** (`appraisal-form-view.vue`)
     - Only shown when `planRunning` exists (from plan selection)
     - Section: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤"
     - Background: ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô (#fff9e6) with yellow border
     - Fields displayed:
       - ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡∏ô (Plan Running Number)
       - ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô (Plan Create Date) - formatted
       - ‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô (Plan Create By)
     - Position: Between "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" and "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤"

  ‚úÖ **Automatic Plan Status Update**
     - When saving appraisal with `planRunning`:
       - Backend updates plan status to `Completed` (statusId = 100)
       - Sets `versionRunning` to the created cost version running
       - Plan disappears from list (no longer Pending)
       - Badge count auto-decreases

  ### API Integration:

  #### 1. List Stock Cost Plans API
  - ‚úÖ **Endpoint**: `POST /StockProduct/ListStockCostPlan`
  - API Store: `usrStockProductApiStore.fetchListStockCostPlan()`
  - Request parameters:
    - `take`, `skip`, `sort` (pagination & sorting)
    - `search.isActive`: true (filter active plans only)
    - `search.statusId`: 10 (filter Pending status only)
    - `search.stockNumber`: optional (filter by stock)
  - Response: DataSourceResult with plan list and total count

  #### 2. Save Appraisal with Plan Reference
  - ‚úÖ **Endpoint**: `POST /StockProduct/AddProductCostDeatialVersion`
  - Additional field: `planRunning` (string, nullable)
  - Backend logic when `planRunning` is provided:
    1. Create cost version as normal
    2. Find plan by running number
    3. Update plan:
       - `versionRunning` = new cost version running
       - `statusId` = 100 (Completed)
       - `statusName` = "Completed"
       - `updateBy` = current user
       - `updateDate` = current datetime

  ### Job Status Constants

  **Location**: `jewelry.Model.Constant.JobStatus.cs`

  ```csharp
  public static class JobStatus
  {
      public static int Pending = 10;      // ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
      public static int Assigned = 20;     // ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
      public static int Started = 30;      // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
      public static int InProgress = 40;   // ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
      public static int OnHold = 50;       // ‡∏û‡∏±‡∏Å‡∏á‡∏≤‡∏ô
      public static int Completed = 100;   // ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
      public static int Cancelled = 500;   // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
  }
  ```

  **Frontend filters**:
  - Badge count: `statusId: 10` (Pending only)
  - Plan modal: `statusId: 10` (Pending only)

  ### Complete Flow:

  ```
  1. [Mobile] ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤
     ‚Üí TbtStockCostPlan created
     ‚Üí statusId = 10 (Pending)
     ‚Üí isActive = true

  2. [Web] ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤
     ‚Üí API call: fetchListStockCostPlan (isActive=true, statusId=10)
     ‚Üí Badge shows count of pending plans
     ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà

  3. [Web] ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏ï‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤"
     ‚Üí Modal opens
     ‚Üí DataTable shows filtered plans (Pending + Active only)
     ‚Üí User selects plan (radio button)
     ‚Üí Click "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏ô‡∏µ‡πâ"

  4. [Web] System loads stock with plan data
     ‚Üí Fetch stock by plan.stockNumber
     ‚Üí Attach plan metadata:
       - planRunning
       - planRemark
       - planCreateDate
       - planCreateBy
     ‚Üí Display plan info section (yellow background)

  5. [Web] User completes appraisal
     ‚Üí Fill in transaction items
     ‚Üí Click "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å" or "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å"
     ‚Üí Request includes planRunning

  6. [Backend] Update plan status
     ‚Üí Create TbtStockCostVersion
     ‚Üí Find plan by planRunning
     ‚Üí Update plan:
       - statusId = 100 (Completed)
       - versionRunning = new version running
       - updateBy, updateDate

  7. [Web] Plan removed from list
     ‚Üí Plan no longer shows in modal (status != Pending)
     ‚Üí Badge count decreases automatically
     ‚Üí Ready for next plan
  ```

  ### Key Differences from Non-Plan Mode:

  | Feature | Without Plan | With Plan |
  |---------|--------------|-----------|
  | Entry Point | Manual stock search | Plan selection modal |
  | Plan Info Display | ‚ùå Hidden | ‚úÖ Shows running, date, creator |
  | Badge Notification | ‚ùå N/A | ‚úÖ Shows pending count |
  | Status Update | ‚ùå N/A | ‚úÖ Auto-updates plan to Completed |
  | `planRunning` Field | `null` | Plan running number |

  ### Files Modified/Created:

  **Backend**:
  - ‚úÖ `jewelry.Model/Stock/Product/ListStockCostPlan/Request.cs` - NEW
  - ‚úÖ `jewelry.Model/Stock/Product/ListStockCostPlan/Response.cs` - NEW
  - ‚úÖ `ProductService.cs` - Added `ListStockCostPlan()` method
  - ‚úÖ `ProductService.cs` - Modified `AddProductCostDeatialVersion()` to update plan status
  - ‚úÖ `IProductService.cs` - Added interface method
  - ‚úÖ `StockProductController.cs` - Added `ListStockCostPlan` endpoint
  - ‚úÖ `AddProductCost/Request.cs` - Already has `PlanRunning` field

  **Frontend**:
  - ‚úÖ `product-api.js` - Added `fetchListStockCostPlan()`
  - ‚úÖ `stock-cost-plan-modal.vue` - NEW component
  - ‚úÖ `search-stock-view.vue` - Added plan button + badge + modal
  - ‚úÖ `appraisal-form-view.vue` - Added plan info section + send planRunning
  - ‚úÖ `index-view.vue` - Handle plan selection event

  ### Notes:
  - ‚ö†Ô∏è Badge notification auto-refreshes only on component mount, not real-time
  - ‚ö†Ô∏è Plan status update happens synchronously during save
  - ‚ö†Ô∏è Only Pending + Active plans are shown in list (statusId=10, isActive=true)
